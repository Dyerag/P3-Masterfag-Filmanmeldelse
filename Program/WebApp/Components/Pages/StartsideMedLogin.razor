@page "/LoggetIn"

<PageTitle>loggetIn</PageTitle>


<!-- Topbar -->
<nav class="topbar">
    <div class="nav">
        <NavLink href="/" class="nav-link home">Hjem</NavLink>
        <form class="search-container">
            <input type="text" @bind="search" placeholder="Søg Film" class="nav-link search" />
        </form>
        <div class="konto">
            <NavLink href="/Opret" class="nav-link opret">Opret bruger</NavLink>
            <NavLink href="/Login" class="nav-link login">Login</NavLink>
        </div>
    </div>
</nav>

<!-- Sidebar -->
<nav class="sidebar">
    <div class="nav-side">
        <p>TOP 10 FILM</p>
        <ul class="liste">
            <li>Alle</li>
            <li>Action</li>
            <li>Animation</li>
            <li>Drama</li>
            <li>Fantasy</li>
            <li>Komedie</li>
            <li>Gyser</li>
            <li>Krimi</li>
            <li>Musical</li>
            <li>Romantik</li>
            <li>Thriller</li>
            <li>Western</li>
        </ul>
    </div>
</nav>

<!-- Top film sektion -->
<nav class="top-movie">
    <div class="left">
        @if (randomLeft != null)
        {
            <div class="content">
                <h1>@randomLeft.Titel</h1>
                <p>@randomLeft.Synopse</p>
                <p class="line">
                    <span>Udgivet: @randomLeft.Udgivelsesdato</span>
                    <span>Rating: @randomLeft.Gennemsnitsanmeldelse</span>
                </p>
            </div>
            <img src="@ConvertToImageUrl(randomLeft.Plakat)" alt="Random Left Film Image" />
        }
    </div>
    <div class="right">
        @if (randomRight != null)
        {
            <div class="content">
                <h1>@randomRight.Titel</h1>
                <p>@randomRight.Synopse</p>
                <p class="line">
                    <span>Udgivet: @randomRight.Udgivelsesdato</span>
                    <span>Rating: @randomRight.Gennemsnitsanmeldelse</span>
                </p>
            </div>
            <img src="@ConvertToImageUrl(randomRight.Plakat)" alt="Random Right Film Image" />
        }
    </div>
</nav>

<!-- Seneste film -->
<nav class="row">
    <div>
        <h1>Seneste Upload</h1>
        <ul>
            @if (latestFilms != null && latestFilms.Any())
            {
                @foreach (var film in latestFilms)
                {
                    <li>
                        <button>
                            <img src="@ConvertToImageUrl(film.Plakat)" alt="Film Plakat" />
                            <p>@film.Titel</p>
                        </button>
                    </li>
                }
            }
        </ul>
    </div>
</nav>

<style>

    body {
        margin: 0;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    /* Topbar */
    .topbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 20px;
        border-bottom: 1px solid #ccc;
        position: relative; /* Tillader absolut placering af søgefeltet */
    }

    .nav {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    /* Center søgefeltet */
    .search-container {
        position: absolute; /* Placer søgefeltet i midten */
        left: 50%; /* Midter søgefeltet horisontalt */
        transform: translateX(-50%); /* Juster position */
        display: flex;
        align-items: center;
        justify-content: center;
    }

        .search-container input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 300px;
        }

    .konto {
        display: flex;
        gap: 10px;
    }

    .nav-link {
        text-decoration: none;
        font-size: 1rem;
        padding: 5px 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        text-align: center;
    }

    /* Sidebar */
    .sidebar {
        width: 200px;
        height: 100%;
        border-right: 1px solid #ccc;
        padding: 10px;
        position: fixed;
        top: 50px; /* Under topbar */
        left: 0;
    }

    .nav-side p {
        font-size: 1.2rem;
        margin-bottom: 10px;
    }

    .liste {
        list-style-type: none;
        padding: 0;
    }

        .liste li {
            margin-bottom: 5px;
            cursor: pointer;
        }

    /* Top Movie Section */
    .top-movie {
        display: flex;
        justify-content: space-around;
        margin-left: 220px; /* Afstand fra sidebar */
        margin-top: 20px;
        gap: 20px;
    }

        .top-movie .left, .top-movie .right {
            width: 45%;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-movie .content {
            flex: 1;
            margin-right: 10px; /* Giver plads mellem tekst og billede */
        }

        .top-movie img {
            width: 150px;
            height: 200px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }


    /* Latest Movies Section */
    .row {
        margin-left: 220px; /* Afstand fra sidebar */
        margin-top: 20px;
    }

        .row h1 {
            font-size: 1.5rem;
        }

        .row ul {
            list-style-type: none;
            display: flex;
            gap: 15px;
            padding: 0;
        }

            .row ul li {
                text-align: center;
            }

                .row ul li img {
                    width: 100px;
                    height: 150px;
                    object-fit: cover;
                    margin-bottom: 5px;
                }

</style>

@code {
    string search = "";

    private FilmDto? randomLeft;
    private FilmDto? randomRight;

    private List<FilmDto>? latestFilms;

    protected override async Task OnInitializedAsync()
    {
        // Hent de seneste 8 film ved hjælp af ImageService
        latestFilms = await Filmservies.GetLatestFilmsAsync();

        var randomFilms = await Filmservies.GetTwoUniqueRandomFilmsAsync();

        randomLeft = randomFilms.Dequeue();
        randomRight = randomFilms.Dequeue();
    }
    // Metode til at konvertere byte-array til Base64-URL for billedvisning
    private string ConvertToImageUrl(byte[] imageBytes)
    {
        return $"data:image/jpeg;base64,{Convert.ToBase64String(imageBytes)}";
    }
}