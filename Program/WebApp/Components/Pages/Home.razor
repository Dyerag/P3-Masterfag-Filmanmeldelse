﻿

@page "/"

<PageTitle>Home</PageTitle>

@inherits LayoutComponentBase
<!-- Topbar -->
<nav class="topbar">
    <div class="nav">
        <NavLink href="/" class="nav-link home">Hjem</NavLink>
        <form class="search-container">
            <input type="text" @bind="search" placeholder="Søg Film" class="nav-link search" />
        </form>
        <div class="konto">
            <NavLink href="/Opret" class="nav-link opret">Opret bruger</NavLink>
            <NavLink href="/Login" class="nav-link login">Login</NavLink>
        </div>
    </div>
</nav>

<!-- Sidebar -->
<nav class="sidebar">
    <div class="nav-side">
        <p>TOP 10 FILM</p>
        <ul class="liste">
            <li>Alle</li>
            <li>Action</li>
            <li>Animation</li>
            <li>Drama</li>
            <li>Fantasy</li>
            <li>Komedie</li>
            <li>Gyser</li>
            <li>Krimi</li>
            <li>Musical</li>
            <li>Romantik</li>
            <li>Thriller</li>
            <li>Western</li>
        </ul>
    </div>
</nav>

<!-- Top film sektion -->
<nav class="top-movie">
    <div class="left">
        @if (randomLeft != null)
        {
            <div class="content">
                <h1>@randomLeft.Titel</h1>
                <p>@randomLeft.Synopse</p>
                <p class="line">
                    <span>Udgivet: @randomLeft.Udgivelsesdato</span>
                    <span>Rating: @randomLeft.Gennemsnitsanmeldelse</span>
                </p>
            </div>
            <img src="@ConvertToImageUrl(randomLeft.Plakat)" alt="Random Left Film Image" />
        }
    </div>
    <div class="right">
        @if (randomRight != null)
        {
            <div class="content">
                <h1>@randomRight.Titel</h1>
                <p>@randomRight.Synopse</p>
                <p class="line">
                    <span>Udgivet: @randomRight.Udgivelsesdato</span>
                    <span>Rating: @randomRight.Gennemsnitsanmeldelse</span>
                </p>
            </div>
            <img src="@ConvertToImageUrl(randomRight.Plakat)" alt="Random Right Film Image" />
        }
    </div>
</nav>

<!-- Seneste film -->
<nav class="row">
    <div>
        <h1>Seneste Upload</h1>
        <ul>
            @if (latestFilms != null && latestFilms.Any())
            {
                @foreach (var film in latestFilms)
                {
                    <li>
                        <button>
                            <img src="@ConvertToImageUrl(film.Plakat)" alt="Film Plakat" />
                            <p>@film.Titel</p>
                        </button>
                    </li>
                }
            }
        </ul>
    </div>
</nav>

<style>

    body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    /* Topbar */
    .topbar {
        position: fixed;
        top: 0; /* Sørger for, at topbaren starter helt øverst */
        left: 0;
        width: 100%;
        height: 60px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 5px 20px; /* Reduceret padding for at mindske højden */
        border-bottom: 1px solid #ccc;
    }

    .nav {
        display: flex;
        align-items: center;
        gap: 20px;
        flex: 1; /* Gør navigationen fleksibel */
    }

    .search-container {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        align-items: center;
        justify-content: center;
    }

        .search-container input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 300px;
        }

    .konto {
        margin-left: auto; /* Flytter konto-sektionen til højre */
        display: flex;
        gap: 10px;
    }

    .nav-link {
        text-decoration: none;
        font-size: 1rem;
        padding: 5px 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        text-align: center;
    }

    /* Sidebar */
    .sidebar {
        width: 200px;
        height: 100%;
        border-right: 1px solid #ccc;
        padding: 10px;
        position: fixed;
        top: 50px; /* Under topbar */
        left: 0;
        text-align: center;
    }

    .nav-side p {
        font-size: 1.2rem;
        margin-bottom: 10px;
    }

    .liste {
        list-style-type: none;
        padding: 0;
    }

        .liste li {
            margin-bottom: 5px;
            cursor: pointer;
        }

    /* Top Movie Section */
    .top-movie {
        display: flex;
        justify-content: space-around;
        margin-left: 220px; /* Afstand fra sidebar */
        margin-top: 40px; /* Forøget afstand fra toppen */
        gap: 20px;
    }

        .top-movie .left, .top-movie .right {
            width: 100%; /* Fylder tilgængelig plads */
            max-width: 750px; /* Maksimal bredde på kassen */
            max-height: 225px; /* Maksimal højde på kassen */
            border: 1px solid #ccc; /* Synlig kantlinje */
            padding: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box; /* Inkluder padding og border i størrelsen */
        }

        .top-movie .content {
            flex: 1;
            margin-right: 10px; /* Giver plads mellem tekst og billede */
            overflow: hidden; /* Skjuler tekst, hvis det bliver for langt */
            text-overflow: ellipsis; /* Tilføjer "..." hvis nødvendigt */
            white-space: normal; /* Tillader flere linjer */
            max-height: 200px; /* Begrænser højden på tekstområdet */
            display: -webkit-box; /* Gør det muligt at begrænse linjer */
            -webkit-line-clamp: 5; /* Maksimalt antal linjer (justér efter behov) */
            -webkit-box-orient: vertical; /* Retningen af tekstblokken */
        }

        .top-movie img {
            width: 150px; /* Fast bredde på billedet */
            height: 200px; /* Fast højde på billedet */
            border: 1px solid #ccc;
            border-radius: 5px;
            object-fit: cover; /* Sørger for, at billedet fylder proportionelt */
        }

        /* Teksten bliver mindre, hvis kassen når maksimal størrelse */
        .top-movie .content h1 {
            font-size: 1.5rem; /* Normal størrelse */
            font-size: calc(1.5rem - 0.3vw); /* Dynamisk størrelse */
            margin: 0 0 10px 0; /* Giver afstand til efterfølgende tekst */
        }

        .top-movie .content p {
            font-size: 1rem; /* Normal størrelse */
            font-size: calc(1rem - 0.2vw); /* Dynamisk størrelse */
            margin: 0; /* Fjerner unødvendig margin */
            line-height: 1.5; /* Gør teksten mere læsbar */
        }

    .line {
        display: flex;
        gap: 20px; /* Afstand mellem span-elementer */
        margin: 0; /* Fjerner ekstra margin omkring linjen */
        flex-wrap: wrap; /* Tillader linjeskift, hvis nødvendigt */
    }

        .line span {
            display: inline-block; /* Sørger for, at de optræder inline */
            margin-top: 5px; /* Giver lidt afstand til toppen */
            font-size: 0.9rem; /* Juster teksten efter behov */
        }






    /* Latest Movies Section */
    .row {
        margin-left: 220px; /* Afstand fra sidebar */
        margin-top: 20px;
    }

        .row h1 {
            font-size: 1.5rem;
        }

        .row ul {
            list-style-type: none;
            display: flex;
            gap: 15px;
            padding: 0;
            justify-content: space-between; /* Fordel pladsen jævnt */
        }

            .row ul li {
                text-align: center;
                flex: 1; /* Sørger for, at elementerne fylder ens */
                max-width: 150px; /* Sætter en fast bredde */
                height: auto; /* Lader højden justeres efter indholdet */
            }

                .row ul li img {
                    width: 150px; /* Fast bredde */
                    height: 200px; /* Fast højde */
                    object-fit: cover; /* Sørger for, at billedet fylder uden at strække */
                    margin-bottom: 5px;
                    border: none; /* Fjerner billedets kantlinje */
                }

                .row ul li button {
                    background: none; /* Fjerner baggrundsfarve */
                    border: none; /* Fjerner kantlinje */
                    padding: 0; /* Fjerner ekstra plads */
                }

                .row ul li p {
                    margin-top: 5px;
                    font-size: 0.9rem; /* Juster tekststørrelse */
                    text-align: center;
                }




</style>

@code {
    string search = "";

    private FilmDto? randomLeft;
    private FilmDto? randomRight;

    private List<FilmDto>? latestFilms;

    protected override async Task OnInitializedAsync()
    {
        // Hent de seneste 8 film ved hjælp af ImageService
        latestFilms = await Filmservies.GetLatestFilmsAsync();

        var randomFilms = await Filmservies.GetTwoUniqueRandomFilmsAsync();

        randomLeft = randomFilms.Dequeue();
        randomRight = randomFilms.Dequeue();
    }
    // Metode til at konvertere byte-array til Base64-URL for billedvisning
    private string ConvertToImageUrl(byte[] imageBytes)
    {
        return $"data:image/jpeg;base64,{Convert.ToBase64String(imageBytes)}";
    }
}